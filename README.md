# -_servicio_soap_en_java_con_oracle_database_19c_- :. .
# Servicio SOAP en Java con Oracle Database 19c .

<img width="1070" height="1000" alt="image" src="https://github.com/user-attachments/assets/7f5b134b-0d83-4c43-8a3a-41bbecfce800" />

<img width="2557" height="1078" alt="image" src="https://github.com/user-attachments/assets/2451ad88-0da4-47dc-bbff-79bdb5fb7723" />    

<img width="2556" height="1079" alt="image" src="https://github.com/user-attachments/assets/22a306c0-b446-4f5d-b1d2-190c0f937e54" />  

<img width="2551" height="1041" alt="image" src="https://github.com/user-attachments/assets/021cac7d-9d38-46c1-80e8-e2e40ca53133" />    

A continuación se presenta una **solución completa, profesional y ejecutable** de un **servicio SOAP en Java**, desarrollada en **IntelliJ IDEA**, que cumple con los siguientes objetivos:

- Exponer información de un avión mediante **SOAP (JAX-WS)** .
- Probarse directamente desde **SoapUI** .
- Registrar la información en **Oracle Database 19c** usando **JDBC** .
- Mantener buenas prácticas académicas y técnicas .

---

## 1. Arquitectura general de la solucion:

### Tecnologías utilizadas

- Java SE 8+
- JAX-WS (SOAP)
- Oracle Database 19c
- JDBC
- IntelliJ IDEA
- SoapUI (cliente de pruebas)

### Componentes
```
┌─────────────────┐
│ SoapUI │
└───────▲─────────┘
│ SOAP
┌───────┴─────────┐
│ Servicio SOAP │
│ AvionService │
└───────▲─────────┘
│ JDBC
┌───────┴─────────┐
│ Oracle DB 19c │
│ TABLA AVION │
└─────────────────┘
```

---

## 2. Script SQL – Oracle Database 19c:

```sql
-- Crear tabla AVION
CREATE TABLE AVION (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    MODELO VARCHAR2(50),
    FABRICANTE VARCHAR2(50),
    CAPACIDAD NUMBER,
    AUTONOMIA NUMBER
);

3. Proyecto Java en IntelliJ IDEA
3.1 Estructura del proyecto

src
 └── avion
     ├── Avion.java
     ├── AvionDAO.java
     ├── AvionService.java
     └── Publicador.java
4. Clase de dominio – Avion.java

package avion;

import java.io.Serializable;

public class Avion implements Serializable {

    private String modelo;
    private String fabricante;
    private int capacidad;
    private int autonomia;

    public Avion() {}

    public Avion(String modelo, String fabricante, int capacidad, int autonomia) {
        this.modelo = modelo;
        this.fabricante = fabricante;
        this.capacidad = capacidad;
        this.autonomia = autonomia;
    }

    public String getModelo() {
        return modelo;
    }

    public void setModelo(String modelo) {
        this.modelo = modelo;
    }

    public String getFabricante() {
        return fabricante;
    }

    public void setFabricante(String fabricante) {
        this.fabricante = fabricante;
    }

    public int getCapacidad() {
        return capacidad;
    }

    public void setCapacidad(int capacidad) {
        this.capacidad = capacidad;
    }

    public int getAutonomia() {
        return autonomia;
    }

    public void setAutonomia(int autonomia) {
        this.autonomia = autonomia;
    }
}
5. Acceso a datos – AvionDAO.java

package avion;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;

public class AvionDAO {

    private static final String URL =
        "jdbc:oracle:thin:@localhost:1521/XEPDB1";
    private static final String USER = "TU_USUARIO";
    private static final String PASS = "TU_PASSWORD";

    public void registrarAvion(Avion avion) {

        String sql = "INSERT INTO AVION (MODELO, FABRICANTE, CAPACIDAD, AUTONOMIA) " +
                     "VALUES (?, ?, ?, ?)";

        try (Connection con = DriverManager.getConnection(URL, USER, PASS);
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setString(1, avion.getModelo());
            ps.setString(2, avion.getFabricante());
            ps.setInt(3, avion.getCapacidad());
            ps.setInt(4, avion.getAutonomia());

            ps.executeUpdate();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
6. Servicio SOAP – AvionService.java

package avion;

import javax.jws.WebMethod;
import javax.jws.WebService;

@WebService
public class AvionService {

    @WebMethod
    public String registrarAvion(
            String modelo,
            String fabricante,
            int capacidad,
            int autonomia) {

        Avion avion = new Avion(modelo, fabricante, capacidad, autonomia);
        AvionDAO dao = new AvionDAO();
        dao.registrarAvion(avion);

        return "Avión registrado correctamente en Oracle 19c";
    }
}
7. Publicador del servicio – Publicador.java

package avion;

import com.sun.net.httpserver.HttpServer;
import com.sun.net.httpserver.HttpExchange;

import java.io.InputStream;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Paths;

public class Publicador {

    public static void main(String[] args) {
        try {
            HttpServer server = HttpServer.create(new InetSocketAddress(8080), 0);

            server.createContext("/AvionService", (HttpExchange exchange) -> {

                /* =========================
                   WSDL
                   ========================= */
                if ("GET".equalsIgnoreCase(exchange.getRequestMethod())
                        && "wsdl".equalsIgnoreCase(exchange.getRequestURI().getQuery())) {

                    byte[] wsdl = Files.readAllBytes(
                            Paths.get("AvionService.wsdl")
                    );

                    exchange.getResponseHeaders().add("Content-Type", "text/xml; charset=utf-8");
                    exchange.sendResponseHeaders(200, wsdl.length);

                    try (OutputStream os = exchange.getResponseBody()) {
                        os.write(wsdl);
                    }
                    return;
                }

                /* =========================
                   SOAP POST
                   ========================= */
                if ("POST".equalsIgnoreCase(exchange.getRequestMethod())) {

                    InputStream is = exchange.getRequestBody();
                    String xml = new String(is.readAllBytes(), StandardCharsets.UTF_8);

                    // Extraer datos del SOAP
                    String modelo = extraer(xml, "modelo");
                    String fabricante = extraer(xml, "fabricante");
                    int capacidad = Integer.parseInt(extraer(xml, "capacidad"));
                    int autonomia = Integer.parseInt(extraer(xml, "autonomia"));

                    // Persistir en Oracle
                    Avion avion = new Avion(modelo, fabricante, capacidad, autonomia);
                    AvionDAO dao = new AvionDAO();
                    dao.registrarAvion(avion);

                    // Respuesta SOAP válida
                    String response =
                            "<?xml version=\"1.0\" encoding=\"UTF-8\"?>" +
                            "<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\">" +
                            "<soapenv:Body>" +
                            "<registrarAvionResponse>" +
                            "<return>Avión registrado correctamente en Oracle 19c</return>" +
                            "</registrarAvionResponse>" +
                            "</soapenv:Body>" +
                            "</soapenv:Envelope>";

                    byte[] responseBytes = response.getBytes(StandardCharsets.UTF_8);

                    exchange.getResponseHeaders().add("Content-Type", "text/xml; charset=utf-8");
                    exchange.sendResponseHeaders(200, responseBytes.length);

                    try (OutputStream os = exchange.getResponseBody()) {
                        os.write(responseBytes);
                    }
                    return;
                }

                exchange.sendResponseHeaders(405, -1);
            });

            server.start();

            System.out.println("Servicio SOAP activo");
            System.out.println("Endpoint:");
            System.out.println("http://localhost:8080/AvionService");
            System.out.println("WSDL:");
            System.out.println("http://localhost:8080/AvionService?wsdl");

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private static String extraer(String xml, String tag) {
        return xml.substring(
                xml.indexOf("<" + tag + ">") + tag.length() + 2,
                xml.indexOf("</" + tag + ">")
        );
    }
}   
8. Ejecución del servicio
Agregar ojdbc8.jar al proyecto
Ejecutar la clase Publicador

Verificar el WSDL en el navegador:
http://localhost:8080/AvionService?wsdl

9. Prueba en SoapUI
9.1 Crear proyecto SOAP
File → New SOAP Project

WSDL URL:
http://localhost:8080/AvionService?wsdl
ENDPOINT SOAPUI:
http://localhost:8080/AvionService        
9.2 Request de ejemplo
xml

<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
   <soapenv:Body>
      <registrarAvion>
         <modelo>Boeing 737</modelo>
         <fabricante>Boeing</fabricante>
         <capacidad>180</capacidad>
         <autonomia>5600</autonomia>
      </registrarAvion>
   </soapenv:Body>
</soapenv:Envelope>
9.3 Respuesta esperada
xml

<return>Avión registrado correctamente en Oracle 19c</return>

10. Resultado final
Servicio SOAP funcional
Probado desde SoapUI
Persistencia correcta en Oracle Database 19c.
Código limpio, modular y reutilizable.
Ideal para proyectos académicos, prácticas SOA o evaluaciones técnicas :. / .
